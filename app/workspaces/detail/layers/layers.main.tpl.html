<div class="layers-tab-inner">
  <h3>Layers</h3>
  <div class="row">
    <div class="col-sm-8">
      <div class="layers-count">
        <strong>{{ layers.length }}</strong> Layer<span ng-if="maps.length==0 || maps.length>1">s</span> in Project <strong>{{ workspace }}</strong>
      </div>
      <small class="sort-by">
        Sort by
        <a class="sort-options" ng-click="predicate='name'; reverse = (last=='name')? !reverse : reverse; last='name';">Name</a> |
        <a class="sort-options" ng-click="predicate='title'; reverse = (last=='title')? !reverse : reverse; last='title';">Title</a> |
        <a class="sort-options" ng-click="predicate='modified.timestamp'; reverse = (last=='modified')? !reverse : reverse; last='modified';">Modified</a> |
        <a class="sort-options" ng-click="predicate='geometry'; reverse = (last=='geometry')? !reverse : reverse; last='geometry';">Type</a> |
        <div class="filter-box">
          <input type="text" class="form-control input-sm grid-filter" ng-model="filterText" placeholder="Filter by..." size="25" />
        </div>
      </small>
    </div>
    <div class="col-sm-4">
      <div class="add-to-map pull-right">
        <span class="add-label">Add Selected Layers to Map:</span>
        <div class="map-picker">
          <ui-select ng-model="map.selected" ng-disabled="disabled" theme="bootstrap" reset-search-input="false" ng-change="setMap(map.selected);">
            <ui-select-match placeholder="Select a map...">
              {{$select.selected.name}}
            </ui-select-match>
            <ui-select-choices repeat="map in mapOptions">
              <span ng-bind-html="map.name | highlight: $select.search"></span>
            </ui-select-choices>
          </ui-select>
        </div>
        <button type="button" class="btn btn-default btn-sm map-button" ng-disabled="!selectedMap" ng-click="addSelectedToMap()">Add</button>
      </div>
    </div>
  </div>
  <div class="layers-summary">
    <div class="row" ng-repeat="row in layers | orderBy:predicate:reverse | partition:3 | filter:filterText">
      <div class="col-sm-4" ng-repeat="layer in row">
        <div class="layer-summary-detail" ng-click="layer.selected = !layer.selected" ng-style="{'outline': layer.selected ? '4px #28728D solid' : ''}">
          <div class="layer-icon">
            <i class='icon-for-layer' ng-class="{'icon-location': layer.geometry=='Point', 'icon-share': layer.geometry=='MultiLineString', 'icon-checkbox-unchecked': layer.geometry=='MultiPolygon', 'icon-delicious': layer.geometry=='raster'}"></i>
          </div>
          <div class="detail">
            <div pop="{{ layer.name }}" pop-show="{{ layer.layerName }}" pop-placement="bottom" ng-click="closeLayerNPopovers(layer);"><strong>{{ layer.name | truncate:false:28:true }}</strong></div>
            <div ng-if="layer.title" pop="{{ layer.title }}" pop-show="{{ layer.layerTitle }}" pop-placement="bottom" ng-click="closeLayerTPopovers(layer);">{{ layer.title | truncate:false:28:true }}</div>
            <div><strong>Modified:</strong> <span ng-if="layer.modified.pretty">{{ layer.modified.pretty }}</span> <span ng-if="!layer.modified">N/A</span></div>
            <!-- <p><a href="" ng-click="newOLWindow(map)">View in OpenLayers</a></p> -->
          </div>
          <div class="layer-details-footer">
            <a ui-sref="layer.style({workspace: layer.workspace, name: layer.name})" title="Edit Layer Style">
              <i class="fa fa-paint-brush"></i> Style
            </a>
            <a ng-click="showAttrs(layer.name, layer.schema.attributes)">{{ layer.schema.attributes.length }} Attributes</a>
            <a ng-click="editLayerSettings(layer);"><i class="fa fa-gear"></i> Settings</a>
            <a title="Copy to New Layer" ng-click="copyToNewLayer(layer);">
              <i class="fa fa-copy"></i> Copy
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div ng-show="layers.length==0">
    <div class="row">
      <div class="col-sm-6">
        <a ng-click="createLayer();">
          <div class="new-layer-box">New Layer
            <div class="plus">+ <i class="icon-stack"></i></div>
          </div>
        </a>
      </div>
    </div>
  </div>
</div>
